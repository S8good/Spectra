# 拉曼光谱用户界面设计

## 1. 整体布局

### 1.1 主窗口结构
- **左侧控制面板**：包含所有参数设置和操作按钮
- **右侧图表区域**：显示光谱数据和分析结果
- **顶部菜单栏**：包含文件、编辑、视图、帮助等菜单
- **底部状态栏**：显示当前状态、测量参数等信息

### 1.2 模式切换
- **欢迎屏幕**：提供不同测量模式的选择，包括拉曼模式
- **模式选择器**：在主窗口中可快速切换不同测量模式
- **拉曼模式图标**：使用专门的拉曼光谱图标标识

## 2. 控制面板设计

### 2.1 采集控制区
- **模式选择**：下拉菜单选择拉曼模式
- **激发波长设置**：
  - 常用波长快速选择按钮（532nm、633nm、785nm）
  - 自定义波长输入框
  - 波长单位显示
- **积分时间调整**：
  - 滑动条快速调整
  - 精确数值输入框
  - 单位显示（ms）
- **激光功率控制**：
  - 百分比滑动条
  - 功率值显示
  - 激光开关按钮（带安全警告）
- **扫描平均**：
  - 数值输入框（1-100）
  - 预设选项（1, 5, 10, 20）
- **采集按钮**：
  - 开始/停止采集
  - 单次采集
  - 连续采集

### 2.2 预处理控制区
- **背景处理**：
  - 采集背景按钮
  - 导入背景按钮
  - 背景扣除开关
- **基线校正**：
  - 多项式阶数选择（1-5）
  - ALS参数调整
  - 手动基线编辑按钮
- **噪声过滤**：
  - 平滑方法选择（无、Savitzky-Golay、移动平均、中值滤波）
  - 平滑窗口大小调整
  - 实时预览开关
- **归一化**：
  - 归一化方法选择（无、峰高、面积、标准物质）
  - 归一化参数调整

### 2.3 分析控制区
- **峰识别**：
  - 自动峰检测开关
  - 峰高阈值调整
  - 峰宽度阈值调整
  - 峰识别算法选择
- **峰拟合**：
  - 拟合函数选择（高斯、洛伦兹、Voigt）
  - 拟合范围选择
  - 多峰拟合开关
  - 拟合质量评估
- **拉曼位移**：
  - 波长/波数切换按钮
  - 波数校准按钮
  - 标准物质选择

### 2.4 拉曼特定工具区
- **SERS分析**：
  - 增强因子计算按钮
  - 基底选择
  - 参考物质选择
- **特征峰数据库**：
  - 内置物质搜索
  - 用户自定义物质管理
  - 谱库匹配按钮
- **高级分析**：
  - 化学计量学分析按钮
  - 机器学习分类按钮
  - 光谱去卷积按钮

### 2.5 数据操作区
- **保存**：
  - 保存当前光谱
  - 保存所有光谱
  - 保存分析结果
- **导出**：
  - 导出数据（CSV、TXT、SPC）
  - 导出图像（PNG、SVG、PDF）
  - 导出报告
- **导入**：
  - 导入光谱数据
  - 导入分析模板
  - 导入参考光谱

## 3. 图表显示区域设计

### 3.1 主光谱显示
- **X轴**：
  - 波长（nm）/波数（cm⁻¹）切换
  - 可调整显示范围
  - 网格显示控制
- **Y轴**：
  - 强度显示
  - 归一化显示
  - 对数/线性刻度切换
- **光谱曲线**：
  - 实时更新
  - 颜色编码（不同光谱不同颜色）
  - 线宽调整
  - 曲线样式选择

### 3.2 峰标记和注释
- **自动峰标记**：
  - 峰位标记
  - 峰强度显示
  - 峰信息 tooltip
- **手动峰标记**：
  - 点击添加标记
  - 拖动调整标记位置
  - 双击编辑标记信息
- **峰数据库集成**：
  - 特征峰自动识别和标记
  - 物质名称显示
  - 参考峰位置对比

### 3.3 多光谱比较
- **光谱叠加**：
  - 添加/删除光谱
  - 光谱透明度调整
  - 光谱偏移显示
- **差分光谱**：
  - 计算并显示差分光谱
  - 差分范围选择
  - 差分阈值调整
- **光谱分组**：
  - 按条件分组显示
  - 分组颜色编码
  - 分组统计信息

### 3.4 交互功能
- **缩放和平移**：
  - 鼠标滚轮缩放
  - 拖拽平移
  - 区域选择放大
  - 重置视图按钮
- **数据点信息**：
  - 鼠标悬停显示详细数据
  - 坐标值实时显示
  - 数据点选择和标记
- **导出选项**：
  - 导出当前视图
  - 导出全范围光谱
  - 导出特定区域

### 3.5 辅助显示
- **峰列表**：
  - 表格形式显示所有识别的峰
  - 可排序和筛选
  - 双击定位到峰位置
- **拟合结果**：
  - 拟合参数显示
  - 拟合残差图
  - 拟合质量指标
- **时间序列**：
  - 连续测量时的时间序列显示
  - 关键参数随时间变化
  - 异常检测和标记

## 4. 交互流程设计

### 4.1 基本测量流程
1. **选择拉曼模式**：从欢迎屏幕或模式选择器选择拉曼模式
2. **设置参数**：
   - 选择激发波长
   - 设置积分时间
   - 调整激光功率
3. **采集背景**：点击采集背景按钮获取背景光谱
4. **开始测量**：点击开始采集按钮
5. **查看结果**：在主图表区域查看拉曼光谱
6. **分析数据**：
   - 自动识别特征峰
   - 切换到波数显示
   - 进行峰拟合
7. **保存结果**：保存光谱数据和分析结果

### 4.2 高级分析流程
1. **导入数据**：导入多个拉曼光谱数据
2. **预处理**：
   - 批量背景扣除
   - 基线校正
   - 噪声过滤
3. **批量分析**：
   - 自动峰识别
   - 峰拟合
   - 拉曼位移计算
4. **比较分析**：
   - 光谱叠加比较
   - 差分分析
   - 聚类分析
5. **结果可视化**：
   - 生成比较图表
   - 创建热图
   - 3D可视化
6. **报告生成**：生成包含所有分析结果的报告

### 4.3 SERS分析流程
1. **设置SERS参数**：
   - 选择基底类型
   - 输入参考物质信息
2. **采集数据**：
   - 采集SERS光谱
   - 采集参考光谱
3. **增强因子计算**：
   - 选择特征峰
   - 输入浓度信息
   - 计算增强因子
4. **结果评估**：
   - 增强因子显示
   - 重复性分析
   - 稳定性评估
5. **报告生成**：生成SERS分析报告

## 5. 响应式设计

### 5.1 不同屏幕尺寸适配
- **大屏幕**：完整显示所有控制面板和图表区域
- **中等屏幕**：自动调整布局，保持关键功能可见
- **小屏幕**：折叠非必要控制面板，优先显示图表区域

### 5.2 触摸设备支持
- **增大按钮尺寸**：适合触摸操作
- **滑动条优化**：便于手指操作
- **手势支持**：
  - 双指缩放
  - 单指平移
  - 长按菜单

### 5.3 键盘快捷键
- **常用操作**：
  - 开始/停止采集：Space
  - 保存：Ctrl+S
  - 导出：Ctrl+E
  - 撤销：Ctrl+Z
- **视图操作**：
  - 缩放：Ctrl+滚轮
  - 重置视图：Ctrl+R
  - 全屏：F11
- **分析操作**：
  - 自动峰检测：Ctrl+D
  - 峰拟合：Ctrl+F
  - 切换波长/波数：Ctrl+W

## 6. 视觉设计

### 6.1 配色方案
- **主色调**：蓝色系（#3B82F6）- 专业、科技感
- **辅助色**：
  - 绿色（#10B981）- 成功、正常状态
  - 红色（#EF4444）- 错误、警告状态
  - 黄色（#F59E0B）- 警告、注意状态
- **中性色**：
  - 深灰（#1F2937）- 背景
  - 中灰（#6B7280）- 次要文本
  - 浅灰（#F3F4F6）- 边框、分隔线

### 6.2 图标设计
- **使用专业科学图标**：
  - 拉曼光谱图标
  - 激光图标
  - 峰识别图标
  - 拟合图标
- **一致性**：所有图标风格统一
- **可识别性**：图标含义清晰易懂
- **响应式**：不同尺寸下保持清晰度

### 6.3 字体选择
- **标题**：无衬线字体，粗体
- **正文**：无衬线字体，常规
- **数据**：等宽字体，便于对齐
- **国际化支持**：支持中文、英文等多语言

### 6.4 动画效果
- **平滑过渡**：参数调整时的平滑过渡
- **加载动画**：长时间操作时的加载指示
- **反馈动画**：操作成功/失败的视觉反馈
- **交互反馈**：按钮点击、滑块调整的视觉反馈

## 7. 可访问性

### 7.1 键盘导航
- **Tab键导航**：所有控件可通过Tab键访问
- **快捷键支持**：常用功能有键盘快捷键
- **屏幕阅读器支持**：所有控件有适当的标签和描述

### 7.2 视觉辅助
- **高对比度模式**：支持高对比度显示
- **字体大小调整**：可调整界面字体大小
- **颜色盲友好**：使用颜色盲友好的配色方案

### 7.3 错误处理
- **明确的错误提示**：错误信息清晰易懂
- **错误恢复建议**：提供解决错误的建议
- **防错设计**：防止用户进行无效操作

## 8. 实现考虑

### 8.1 技术实现
- **基于现有框架**：利用现有的PyQt5和pyqtgraph框架
- **模块化设计**：将拉曼功能模块化，便于维护和扩展
- **性能优化**：
  - 实时数据处理优化
  - 大型数据集的高效处理
  - 多线程处理计算密集型任务

### 8.2 集成策略
- **无缝集成**：与现有测量模式无缝集成
- **模式切换**：保持不同模式间的一致性
- **数据共享**：不同模式间可共享数据和设置

### 8.3 测试策略
- **单元测试**：测试各个功能模块
- **集成测试**：测试模块间的交互
- **用户测试**：收集用户反馈，优化界面

## 9. 未来扩展

### 9.1 功能扩展
- **更多硬件支持**：支持更多型号的拉曼光谱仪
- **高级分析工具**：添加更多高级分析方法
- **机器学习集成**：集成更多机器学习模型

### 9.2 界面扩展
- **自定义布局**：允许用户自定义界面布局
- **主题支持**：支持多种界面主题
- **多语言支持**：支持更多语言

### 9.3 平台扩展
- **Web界面**：开发基于Web的远程控制界面
- **移动应用**：开发移动应用进行远程监控
- **云集成**：集成云存储和分析服务

## 10. 总结

本设计文档详细说明了拉曼光谱功能的用户界面布局和交互流程，旨在提供一个专业、直观、高效的拉曼光谱测量和分析工具。通过合理的布局设计和流畅的交互流程，用户可以轻松完成从数据采集到分析、可视化和报告生成的整个工作流程。

该设计充分考虑了拉曼光谱的专业需求，同时保持了与现有系统的一致性和兼容性，为用户提供了一个功能强大且易于使用的拉曼光谱分析平台。